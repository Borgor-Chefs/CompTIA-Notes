---
tags:
  - os
  - macos
---
# Malware Protection

>All information about this note is pulled from [here](https://support.apple.com/en-ca/guide/security/sec469d47bd8/web).

This is actually quite the setup that Apple has invented. There are three steps of malware protection:

- prevent the distribution of execution of malware
- block malware from running on systems
- remediate malware that has executed

## Notarization

All applications that are developed for macOS have to be approved by Apple itself. Every application that gets uploaded submits to a scan performed by Apple's Notarization, which will scan all the files included by the application for known malware signatures (YARA signatures). If the application is clean, it will be allowed onto the app store and will be issued a Notarization ticket.

Otherwise, if any malware is detected, Apple will revoke any developer certificates issues to the developer and will block the application from being uploaded to the App Store.

Finally, Apple can also issue a revocation ticket for apps that are known to be malicious, even if they've been approved.

## Gatekeeper

From the sounds of it, Gatekeeper reads the Notarization ticket within the `.app` file to verify it even when running offline. If the ticket is invalid or Gatekeeper has a revocation ticket for a certain application, my guess is that it will either notify XProtect or it will simply prevent the software from launching.

## XProtect

Apple uses their own application XProtect to analyze program signatures and files to see if they contain any known malware signatures. This database of signatures is updated regularly, I'm assuming XProtect makes a connection to some centralized Apple database of malware signatures and fetches it periodically.

XProtect checks for known malicious content whenever:

- an app is first launched
- an app has been changed (in the file system)
- XProtect signatures are updated

Whenever XProtect detects malware, the software is immediately blocked, the user is notified of this and is given the option to move the software into the trash. 

>Apple says that XProtect's methods are more "generic" than just file hashes, allowing it to detect malware that it hasn't even seen yet.  
>Not sure what this means or entails.

XProtect will occasionally scan your system for malware and gets updates from Apple itself whenever you decide to update the system.
