---
tags:
  - os
  - macos
---
# Malware Protection

>All information about this note is pulled from [here](https://support.apple.com/en-ca/guide/security/sec469d47bd8/web).

This is actually quite the setup that Apple has invented. There are three steps of malware protection:

- prevent the distribution of execution of malware
- block malware from running on systems
- remediate malware that has executed

## Notarization

All applications that are developed for macOS have to be approved by Apple itself. Every application that gets uploaded submits to a scan performed by Apple's Notarization, which will scan all the files included by the application for known malware signatures (YARA signatures). If the application is clean, it will be allowed onto the app store and will be issued a Notarization ticket.

Otherwise, if any malware is detected, Apple will revoke any developer certificates issues to the developer and will block the application from being uploaded to the App Store.

Finally, Apple can also issue a revocation ticket for apps that are known to be malicious, even if they've been approved.

## Gatekeeper

From the sounds of it, Gatekeeper reads the Notarization ticket within the `.app` file to verify it even when running offline. If the ticket is invalid or Gatekeeper has a revocation ticket for a certain application, my guess is that it will either notify XProtect or it will simply prevent the software from launching.

## XProtect

![[XProtect]]
