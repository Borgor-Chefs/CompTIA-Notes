---
tags:
  - security
  - malware
---
# Removing the Malware

>This guide revolves around [[!Windows|Windows]], this does **not** cover removing viruses from [[!Linux|Linux]] nor [[!Apple|macOS]].

It's almost impossible to know whether or not you've removed all the [[!Malware|malware]] from a computer. Your best bet (usually) is to completely reinstall the system itself and start anew.

Here are the steps to take when removing malware from a system:

1. verify that there is malware, it's possible that the user is mistaking slow performance for the presence of malware
2. quarantine the infected computer
3. disable system restore
4. remediate
5. schedule scans and run updates
6. reenable system restore
7. educate the victim

## Verify That Malware is Present

With malware, it varies from invisible/passive where it tries it's best not to trigger any alarms to complete fuck you in your face give it money.

Odds are, Windows will tell you when it detects malware (and it's 99% accurate, a number I pulled fresh from my ass but it does it's job) it will give you messages like application failures, security alerts.

![[Pasted image 20240225143814.png]]

Something like the above image. You will also notice things like system performance issues i.e., slow boot, slow applications, etc. This being said, you will also be able to monitor this using [[Task Manager]] and [[Performance Monitor]].

It is also important to research the malware you're dealing with, if you can identify it. For instance, there are tools to remove WannaCry from your PC.

## Quarantine the Infected Computer

You should (almost) immediately disconnect the infected PC from the network to contain the spread of the virus (you can ensure this if the PC only has an ethernet connection and no [[Network Interface Card|wifi card]]).

>I say almost here because in some environments, you might want to analyze what the virus will do.

You should isolate all removable media i.e., remove any [[USB Stick|USB drives]], any [[External Hard Drive|external HDDs]] and such and put it somewhere you'll remember. These devices can be infected and it's good to verify them in a secure way before re-using them (or just wipe them if it's easier).

Finally, don't try and transfer files to or from the PC or try to backup the PC. You're already infected and by doing this you could make it worse.

## Disable System Restore

This is something that isn't immediately apparent. You should do this because viruses will often try to corrupt/infect any backups of Windows which (most likely) include registry keys, things that the virus will use to its advantage.

By doing this, you will however destroy all previous backups you've created. But, these backups are **only** Windows configurations, so it's not all lost.

If any files are infected or corrupted, well that's a different story. Your best bet is to try and secure delete them.

## Remediate

There are two parts here:

1. update the anti-virus
2. scan and remove

### Update the Anti-Virus

It's best to try and update your anti-virus as it being out of date or not having the latest signatures was most likely the reason the person has a virus running on their computer now.

>Or just don't download sketchy shit like "FREE BREAKING BAD ALL 20 SEASONS NOW" or clicking on ads like "Hot Milfs in your area, click here!".

What you might experience is that you are unable to update your anti-virus, almost certainly due to the malware running on your PC. What you can do instead is download the latest signatures from another PC, put them onto a USB drive and transfer them over to the infected computer.

>Naturally, you will have to quarantine the USB drive so don't use one that's important.

### Scan and Remove

Now that you've (hopefully) updated your anti-virus, try scanning and removing all threats on your PC. Sometimes (like I mentioned earlier), you might have to use a third party tool to remove whatever malware is infecting your PC.

>Like before, it's hard to know whether or not you've completely removed the malware from your computer. It's a good idea to just reinstall from scratch.

You can also boot into Safe Mode which loads just enough software to have a bare minimum operating system. It can also prevent bad things from starting (although this isn't foolproof).

Finally, you can boot into a pre-installation environment (WinPE) from a USB stick. You can also build your own from the "Windows Assessment and Deployment Kit (ADK)".

## Schedule Scans and Run Updates

Here, after you've determined that the malware has been removed, you should enable automatic scans of the PC, automatic downloading of virus signatures from your anti-virus and update the installation of Windows.

>You can start and stop services from [[Task Scheduler]].

## Reenable System Restore

Reenable system restore now and create a backup of the system after you've removed the malware.

## Educate the Victim

You should tell the victim (ideally):

- how they got infected
- what they were infected with
- or even if they were infected and it wasn't just some other issue

You can do this by:

- a one on one personal training session or seminar
- posters and signs
- a company or local message board posting
- a login message
- or intranet page
